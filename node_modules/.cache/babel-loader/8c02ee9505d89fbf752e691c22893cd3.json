{"ast":null,"code":"'use strict';\n\nvar _classCallCheck = require(\"/Users/isaac/Downloads/react_spa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/Users/isaac/Downloads/react_spa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createClass\");\n\nvar Bluebird = require('bluebird');\n\nvar Request = require('request');\n\nvar Stream = require('stream');\n\nvar ResourceBase = /*#__PURE__*/function () {\n  function ResourceBase(endpoint, config) {\n    _classCallCheck(this, ResourceBase);\n\n    this.uri = \"\".concat(config.options.host).concat(endpoint);\n    this.config = config.options;\n  }\n\n  _createClass(ResourceBase, [{\n    key: \"_transmit\",\n    value: function _transmit(method, uri, qs, form, headers, callback) {\n      if (typeof headers === 'function') {\n        callback = headers;\n        headers = {};\n      } else {\n        headers = headers || {};\n      }\n\n      var allHeaders = Object.assign({}, this.config.headers, headers);\n      var opts = {\n        url: \"\".concat(this.uri).concat(uri ? \"/\".concat(uri) : ''),\n        method: method,\n        auth: {\n          user: this.config.apiKey,\n          password: ''\n        },\n        headers: allHeaders,\n        json: true\n      };\n\n      if (this.config.agent) {\n        opts.agent = this.config.agent;\n      }\n\n      var isMultiPartForm = false;\n\n      for (var key in form) {\n        if (form[key] === undefined) {\n          delete form[key];\n        }\n\n        if (form[key] === true || form[key] === false) {\n          form[key] = form[key].toString();\n        }\n      }\n\n      for (var param in form) {\n        var val = form[param];\n\n        if (val instanceof Stream.Stream) {\n          isMultiPartForm = true;\n          break;\n        }\n\n        if (val !== undefined && val !== null && Object.prototype.hasOwnProperty.call(val, 'value')) {\n          isMultiPartForm = true;\n          break;\n        }\n      }\n\n      if (qs) {\n        opts.qs = qs;\n      }\n\n      if (form) {\n        if (isMultiPartForm) {\n          opts.formData = form;\n        } else {\n          opts.form = form;\n        }\n      }\n\n      return new Bluebird(function (resolve, reject) {\n        Request(opts, function (err, resp, body) {\n          body = body || {};\n          /* istanbul ignore next */\n\n          if (err) {\n            return reject(err);\n          }\n\n          if (body && body.error) {\n            var error = new Error(body.error.message);\n            error.status_code = body.error.status_code;\n            error._response = resp;\n            return reject(error);\n          }\n\n          if (resp && resp.statusCode >= 500) {\n            var _error = new Error(resp.statusMessage);\n\n            _error.status_code = resp.statusCode;\n            _error._response = resp;\n            return reject(_error);\n          }\n\n          Object.defineProperty(body, '_response', {\n            enumerable: false,\n            writable: false,\n            value: resp\n          });\n          return resolve(body);\n        });\n      }).nodeify(callback);\n    }\n  }]);\n\n  return ResourceBase;\n}();\n\nmodule.exports = ResourceBase;","map":{"version":3,"sources":["/Users/isaac/Downloads/react_spa/node_modules/lob/lib/resources/resourceBase.js"],"names":["Bluebird","require","Request","Stream","ResourceBase","endpoint","config","uri","options","host","method","qs","form","headers","callback","allHeaders","Object","assign","opts","url","auth","user","apiKey","password","json","agent","isMultiPartForm","key","undefined","toString","param","val","prototype","hasOwnProperty","call","formData","resolve","reject","err","resp","body","error","Error","message","status_code","_response","statusCode","statusMessage","defineProperty","enumerable","writable","value","nodeify","module","exports"],"mappings":"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","sourcesContent":["'use strict';\n\nconst Bluebird = require('bluebird');\nconst Request  = require('request');\nconst Stream   = require('stream');\n\nclass ResourceBase {\n\n  constructor (endpoint, config) {\n    this.uri = `${config.options.host}${endpoint}`;\n    this.config = config.options;\n  }\n\n  _transmit (method, uri, qs, form, headers, callback) {\n    if (typeof headers === 'function') {\n      callback = headers;\n      headers = {};\n    } else {\n      headers = headers || {};\n    }\n\n    const allHeaders = Object.assign({}, this.config.headers, headers);\n\n    const opts = {\n      url: `${this.uri}${uri ? `/${uri}` : ''}`,\n      method,\n      auth: { user: this.config.apiKey, password: '' },\n      headers: allHeaders,\n      json: true\n    };\n\n    if (this.config.agent) {\n      opts.agent = this.config.agent;\n    }\n\n    let isMultiPartForm = false;\n\n    for (const key in form) {\n      if (form[key] === undefined) {\n        delete form[key];\n      }\n      if (form[key] === true || form[key] === false) {\n        form[key] = form[key].toString();\n      }\n    }\n\n    for (const param in form) {\n      const val = form[param];\n\n      if (val instanceof Stream.Stream) {\n        isMultiPartForm = true;\n        break;\n      }\n\n      if (val !== undefined && val !== null && Object.prototype.hasOwnProperty.call(val, 'value')) {\n        isMultiPartForm = true;\n        break;\n      }\n    }\n\n    if (qs) {\n      opts.qs = qs;\n    }\n\n    if (form) {\n      if (isMultiPartForm) {\n        opts.formData = form;\n      } else {\n        opts.form = form;\n      }\n    }\n\n    return new Bluebird((resolve, reject) => {\n      Request(opts, (err, resp, body) => {\n        body = body || {};\n\n        /* istanbul ignore next */\n        if (err) {\n          return reject(err);\n        }\n\n        if (body && body.error) {\n          const error = new Error(body.error.message);\n          error.status_code = body.error.status_code;\n          error._response = resp;\n          return reject(error);\n        }\n\n        if (resp && resp.statusCode >= 500) {\n          const error = new Error(resp.statusMessage);\n          error.status_code = resp.statusCode;\n          error._response = resp;\n          return reject(error);\n        }\n\n        Object.defineProperty(body, '_response', {\n          enumerable: false,\n          writable: false,\n          value: resp\n        });\n\n        return resolve(body);\n      });\n    }).nodeify(callback);\n  }\n\n}\n\nmodule.exports = ResourceBase;\n"]},"metadata":{},"sourceType":"script"}